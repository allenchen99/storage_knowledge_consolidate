
# åº”ç”¨ç¨‹åº I/O Pattern åˆ†ææ–¹æ³•ï¼ˆç”±æµ…å…¥æ·±ï¼‰

## 1. ä½¿ç”¨ç³»ç»Ÿçº§å·¥å…·é‡‡é›† I/O è¡Œä¸º

### ğŸ§° Linux å·¥å…·ï¼š

| å·¥å…·               | åŠŸèƒ½è¯´æ˜                               |
|--------------------|--------------------------------------|
| `iostat`           | æŸ¥çœ‹è®¾å¤‡ IOPSã€ååã€é˜Ÿåˆ—æ·±åº¦ï¼ˆ`-x` å‚æ•°æ›´è¯¦ç»†ï¼‰ |
| `vmstat`           | æŸ¥çœ‹ç³»ç»Ÿ I/O ç­‰å¾…æƒ…å†µï¼ˆ`wa` åˆ—ï¼‰          |
| `pidstat -d`       | æŸ¥çœ‹æ¯ä¸ªè¿›ç¨‹çš„ç£ç›˜ I/O                    |
| `iotop`            | å®æ—¶æŸ¥çœ‹å“ªäº›è¿›ç¨‹åœ¨åšå¤§é‡ I/O               |
| `dstat`            | å®æ—¶ç›‘æ§å¤šç»´åº¦ I/O æŒ‡æ ‡                    |
| `blktrace` / `btt` | å†…æ ¸çº§å—è®¾å¤‡ I/O è·Ÿè¸ªï¼Œè¾“å‡ºè¯·æ±‚ç±»å‹ã€å¤§å°ã€æ—¶é—´ç­‰ |
| `strace -e read,write` | è¿½è¸ªæŸç¨‹åºçš„ I/O ç³»ç»Ÿè°ƒç”¨ï¼ˆç²—ç•¥ï¼Œä½†èƒ½çœ‹ syscall çº§åˆ«è¡Œä¸ºï¼‰ |

### ç¤ºä¾‹ï¼š

```bash
iostat -x 1
iotop -aoP   # ç´¯è®¡ I/O æ’åº
pidstat -d -p <PID> 1

## 2. ä½¿ç”¨ fio job replay æˆ– workload capture å·¥å…·
å¦‚æœä½ èƒ½æ§åˆ¶æˆ–æ¨¡æ‹Ÿåº”ç”¨ï¼Œå¯åœ¨ç”Ÿäº§æˆ–æµ‹è¯•ç¯å¢ƒä½¿ç”¨å·¥å…·é‡ç°å¹¶åˆ†æå®é™… I/O patternã€‚

### ğŸ”§ æ–¹æ³• Aï¼šfio job trace
ä½¿ç”¨ fio çš„ --write_iolog å’Œ --read_iolog åŠŸèƒ½ï¼š

bash
Copy
Edit
fio --filename=/path/to/file --rw=randrw --bs=4k --runtime=60 --write_iolog=trace.log
ç„¶åå¯ç”¨ --read_iolog å›æ”¾ã€åˆ†æã€‚

### ğŸ”§ æ–¹æ³• Bï¼šreplay io trace from real appsï¼ˆä¾‹å¦‚ Vdbench trace æˆ– blktraceï¼‰
ä½¿ç”¨ä¸“ä¸šå·¥å…·æ•è·çœŸå®åº”ç”¨ I/O trace

é€šè¿‡å·¥å…·è½¬æ¢æˆ–è‡ªå®šä¹‰è„šæœ¬å®ç°é‡æ”¾
